[Unit]
Description=JBoss Keycloak Announcer

Requires=etcd.service
Requires=keycloak.service

After=etcd.service
After=keycloak.service
BindsTo=keycloak.service

[Service]
EnvironmentFile=-/etc/environment
ExecStart=/services/default-discovery.sh -d keycloak -e keycloak -p web=8080/tcp -ip ${COREOS_PUBLIC_IPV4} -h %h
ExecStop=-/usr/bin/etcdctl rm /services/keycloak

[X-Fleet]
MachineOf=keycloak.service
